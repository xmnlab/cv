\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{template}[2025/10/31 Sonia-style clean CV layout]

% --------- Core setup (pdfLaTeX first) ----------
\RequirePackage[a4paper,top=1.8cm,bottom=2.6cm,left=1.6cm,right=1.6cm]{geometry}
\RequirePackage{iftex}
\ifPDFTeX
  \RequirePackage[T1]{fontenc}
  \RequirePackage[utf8]{inputenc}
  \RequirePackage{lmodern}
  \renewcommand{\familydefault}{\sfdefault}
\else
  \RequirePackage{fontspec}
  \IfFontExistsTF{Inter}{\setmainfont{Inter}}{\setmainfont{Latin Modern Sans}}
\fi
\RequirePackage[final]{microtype}
\RequirePackage{parskip}
\RequirePackage{ragged2e}
\RequirePackage{graphicx}
\RequirePackage{paracol}
\RequirePackage{titlesec}
\RequirePackage{enumitem}
\RequirePackage{tabularx}
\RequirePackage{array}
\RequirePackage[hidelinks]{hyperref}
\RequirePackage[dvipsnames]{xcolor}
\RequirePackage{tikz}
\RequirePackage{fancyhdr}

% --------- Colors ----------
\definecolor{Primary}{HTML}{111827}  % near-black
\definecolor{Muted}{HTML}{6B7280}    % gray
\definecolor{Hairline}{HTML}{2F2F2F} % divider / rules

\hypersetup{colorlinks=true,linkcolor=Primary,urlcolor=Primary}

% --------- Lists & spacing ----------
\setlist[itemize]{leftmargin=*,topsep=2pt,itemsep=2pt}
\setlist[enumerate]{leftmargin=*,topsep=2pt,itemsep=2pt}
\setlength{\tabcolsep}{0pt}

% --------- Section headings ----------
\titleformat{\section}{\large\bfseries\color{Primary}}{}{0pt}{}
\titlespacing*{\section}{0pt}{10pt}{6pt}

% --------- Name block (right column) ----------
\newcommand{\NameBlock}[2]{%
  \noindent{\fontsize{30}{32}\selectfont\bfseries #1}\par\vspace{2pt}%
  {\large\color{Muted} #2}\par\vspace{4pt}%
  \color{Hairline}\rule{\linewidth}{0.6pt}\par\vspace{10pt}%
}

% --------- Left/Right section title with thin rule ----------
\newcommand{\LeftSection}[1]{%
  \vspace{10pt}\noindent\textbf{\MakeUppercase{#1}}\par\vspace{6pt}%
}
\newcommand{\RightSection}[1]{%
  \vspace{10pt}\noindent\textbf{\MakeUppercase{#1}}\par\vspace{6pt}%
}

% --------- Entries ----------
% Education: degree, inst, years
\newcommand{\EduEntry}[3]{%
  \noindent\begin{tabularx}{\linewidth}{@{}Xr@{}}
    \textbf{#1} \\[-1pt] {\small #2} & {\small #3}
  \end{tabularx}\par\vspace{6pt}%
}
% Experience: role, company (city), dates
\newcommand{\ExpHead}[3]{%
  \noindent\begin{tabularx}{\linewidth}{@{}Xr@{}}
    \textbf{#1} \\[-1pt] {\small #2} & {\small #3}
  \end{tabularx}\par
}
\newenvironment{tightitemize}{\begin{itemize}[leftmargin=*,topsep=2pt,itemsep=2pt]}{\end{itemize}}

% --------- Photo with strap (left column) ----------
% Usage: \Photo[3.5cm]{path/to/photo.jpg}
\newcommand{\Photo}[2][3.5cm]{%
  \begin{center}
    {\color{Primary}\rule{8pt}{1.8cm}}\\[-1.2cm]
    \includegraphics[width=#1]{#2}
  \end{center}
}

% --------- Simple skill bar (0..1) ----------
\newcommand{\Skill}[2]{% label, fraction (e.g., 0.8)
  \noindent #1\par
  \begin{tikzpicture}
    \pgfmathsetlengthmacro{\barw}{#2*\linewidth}
    \fill[gray!25] (0,0) rectangle (\linewidth,0.12);
    \fill[black]   (0,0) rectangle (\barw,0.12);
  \end{tikzpicture}\par\vspace{6pt}%
}

% --------- Columns + divider ----------
\setlength{\columnsep}{0.9cm}
\setlength{\columnseprule}{0.6pt}
\def\DividerColor{\color{Hairline}}
\let\old@makecolseprule\make@colseprule
\def\make@colseprule{\DividerColor\old@makecolseprule} % color the vertical rule

\newcommand{\StartCVColumns}{\columnratio{0.36,0.64}\begin{paracol}{2}}
\newcommand{\EndCVColumns}{\end{paracol}}

% --------- Footer bar ----------
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.4pt}
\newcommand{\SetFooter}[3]{%
  \fancyfoot[L]{\small \textbf{PHONE:} \, #1}%
  \fancyfoot[C]{\small \textbf{MAIL:} \, \href{mailto:#2}{#2}}%
  \fancyfoot[R]{\small \textbf{ADDRESS:} \, #3}%
}
